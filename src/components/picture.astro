---
export interface DalleImage {
  url: string;
  srcset: {
    webp: string[];
    jpg: string[];
  };
}

const {
  image,
  alt,
  class: className = ''
} = Astro.props;

const mediaUrl = import.meta.env.MEDIA_URL;

// Crea srcset per webp e jpg
const webpSrcset = image.srcset.webp?.map(url => `${mediaUrl}${url}`).join(', ') || '';
const jpgSrcset = image.srcset.jpg?.map(url => `${mediaUrl}${url}`).join(', ') || '';
---

<picture>
  {webpSrcset && (
    <source
      srcset={webpSrcset}
      type="image/webp"
    />
  )}
  
  {jpgSrcset && (
    <source
      srcset={jpgSrcset}
      type="image/jpeg"
    />
  )}
  
  <img
    src={mediaUrl + image.url}
    alt={alt}
    loading="lazy"
    decoding="async"
    class={className}
  />
</picture>